<!DOCTYPE html>
<html lang="en-us"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Mikrotik Securing Router With Firewall | Peters Website</title>
<meta property="og:title" content="Mikrotik Securing Router With Firewall | Peters Website" />
<meta name="twitter:title" content="Mikrotik Securing Router With Firewall | Peters Website" />
<meta itemprop="name" content="Mikrotik Securing Router With Firewall | Peters Website" />
<meta name="application-name" content="Mikrotik Securing Router With Firewall | Peters Website" />
<meta property="og:site_name" content="Peter&#39;s blog" />

<meta name="description" content="Random blog posts...some techy and some not">
<meta itemprop="description" content="Random blog posts...some techy and some not" />
<meta property="og:description" content="Random blog posts...some techy and some not" />
<meta name="twitter:description" content="Random blog posts...some techy and some not" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />



  <meta itemprop="image" content="https://peterunix.github.io/" />
  <meta property="og:image" content="https://peterunix.github.io/" />
  <meta name="twitter:image" content="https://peterunix.github.io/" />
  <meta name="twitter:image:src" content="https://peterunix.github.io/" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2023-07-28T12:55:34-0700 />
    <meta property="article:published_time" content=2023-07-28T12:55:34-0700 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Mikrotik Securing Router With Firewall",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2023-07-28",
        "description": "",
        "wordCount":  824 ,
        "mainEntityOfPage": "True",
        "dateModified": "2023-07-28",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Peters Website"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.115.4">

    

    <link rel="canonical" href="https://peterunix.github.io/posts/mikrotik-securing-router-with-firewall/">
    <link href="/style.min.d16f523c36741e07697791cfe4bcb09b8c92c7034d5cbf85980df65d92a70e97.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://peterunix.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://peterunix.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        About
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Mikrotik Securing Router With Firewall</h1>
                
                
                <div class="post-meta">
                    <time datetime="2023-07-28T12:55:34-07:00" itemprop="datePublished"> 28 Jul 2023 </time>
                </div>
                
            </header>
            <details class="toc">
                <summary><b>Table of Contents</b></summary>
                <nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Fresh Start</a>
</li>
<li><a href="#headline-2">Default Firewall Rules</a>
</li>
<li><a href="#headline-3">Creating a New User Account</a>
</li>
<li><a href="#headline-4">Changing SSH/Winbox Ports</a>
</li>
<li><a href="#headline-5">Preventing Brute Force</a>
<ul>
<li><a href="#headline-6">Whitelisting a Trusted Host</a>
</li>
<li><a href="#headline-7">Preventing SSH Brute Force</a>
</li>
<li><a href="#headline-8">Preventing WinBox Brute Force</a>
</li>
</ul>
</li>
<li><a href="#headline-9">Disabling Access Via MAC Address</a>
</li>
<li><a href="#headline-10">Disabling Services</a>
<ul>
<li><a href="#headline-11">Login Services</a>
</li>
<li><a href="#headline-12">Miscellenous Services</a>
</li>
<li><a href="#headline-13">Disabling DNS cache</a>
</li>
</ul>
</li>
</ul>
</nav>
            </details><div class="page-content">
                
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Fresh Start
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>Incase you mess up or want a fresh start, run these two commands to clear all firewall rules and address lists. Note that if you re-run the command to add a filter, it&#39;ll either error out or duplicate if it already exists.</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/ip/firewall/filter remove <span class="o">[</span>find <span class="nv">dynamic</span><span class="o">=</span>no<span class="o">]</span>
</span></span><span class="line"><span class="cl">/ip/firewall/address-list remove <span class="o">[</span>find <span class="nv">dynamic</span><span class="o">=</span>no<span class="o">]</span></span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Default Firewall Rules
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>These are the default IPv4 firewall filters suggested by Mikrotik. They work very well and prevent unwanted connections from the WAN interface. Note that IPv6 is disabled by default on Mikrotiks and were it to be enabled, any firewall rules are not configured for it.</p>
<p>
On the line last line of the first code block, replace src-address=! with your LAN IP range.</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">action</span><span class="o">=</span>fasttrack-connection <span class="nv">chain</span><span class="o">=</span>forward <span class="nv">comment</span><span class="o">=</span>FastTrack connection-state<span class="o">=</span>established,related
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">action</span><span class="o">=</span>accept <span class="nv">chain</span><span class="o">=</span>forward <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Established, Related&#34;</span>  connection-state<span class="o">=</span>established,related
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">action</span><span class="o">=</span>drop <span class="nv">chain</span><span class="o">=</span>forward <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Drop invalid&#34;</span> connection-state<span class="o">=</span>invalid <span class="nv">log</span><span class="o">=</span>yes log-prefix<span class="o">=</span>invalid
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">action</span><span class="o">=</span>drop <span class="nv">chain</span><span class="o">=</span>forward <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Drop tries to reach not public addresses from LAN&#34;</span> dst-address-list<span class="o">=</span>not_in_internet in-interface<span class="o">=</span>bridge1 <span class="nv">log</span><span class="o">=</span>yes log-prefix<span class="o">=</span>!public_from_LAN out-interface<span class="o">=</span>!bridge1
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">action</span><span class="o">=</span>drop <span class="nv">chain</span><span class="o">=</span>forward <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Drop incoming packets that are not NATted&#34;</span> connection-nat-state<span class="o">=</span>!dstnat connection-state<span class="o">=</span>new in-interface<span class="o">=</span>ether1 <span class="nv">log</span><span class="o">=</span>yes log-prefix<span class="o">=</span>!NAT
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">action</span><span class="o">=</span>drop <span class="nv">chain</span><span class="o">=</span>forward <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Drop incoming from internet which is not public IP&#34;</span> in-interface<span class="o">=</span>ether1 <span class="nv">log</span><span class="o">=</span>yes log-prefix<span class="o">=</span>!public src-address-list<span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">action</span><span class="o">=</span>drop <span class="nv">chain</span><span class="o">=</span>forward <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Drop packets from LAN that do not have LAN IP&#34;</span> in-interface<span class="o">=</span>bridge1 <span class="nv">log</span><span class="o">=</span>yes log-prefix<span class="o">=</span>LAN_!LAN src-address<span class="o">=</span>!192.168.1.0/24
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>0.0.0.0/8 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>172.16.0.0/12 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>192.168.0.0/16 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>10.0.0.0/8 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>169.254.0.0/16 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>127.0.0.0/8 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>224.0.0.0/4 <span class="nv">comment</span><span class="o">=</span>Multicast <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>198.18.0.0/15 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>192.0.0.0/24 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>192.0.2.0/24 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>198.51.100.0/24 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>203.0.113.0/24 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>100.64.0.0/10 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>240.0.0.0/4 <span class="nv">comment</span><span class="o">=</span>RFC6890 <span class="nv">list</span><span class="o">=</span>not_in_internet
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>192.88.99.0/24 <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;6to4 relay Anycast [RFC 3068]&#34;</span> <span class="nv">list</span><span class="o">=</span>not_in_internet</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Creating a New User Account
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>Here we&#39;ll create a new administrative user and delete the default admin account. The username should be unique to prevent dictionary attacks.</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/user add <span class="nv">name</span><span class="o">=</span>SECURE_USER_NAME <span class="nv">password</span><span class="o">=</span>SUPER_SECURE_PASSWORD <span class="nv">group</span><span class="o">=</span>full
</span></span><span class="line"><span class="cl">/user remove admin</span></span></code></pre></div>
</div>
<p>
Afterward, we can set WinBox to only allow the user to login on a specific subnet.</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/user <span class="nb">set</span> USERNAME <span class="nv">address</span><span class="o">=</span>192.168.1.0/24</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Changing SSH/Winbox Ports
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>Here we&#39;ll change the default SSH port to 1950 and the default Winbox port to 1951</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/ip/service/set ssh <span class="nv">port</span><span class="o">=</span><span class="m">1950</span>
</span></span><span class="line"><span class="cl">/ip/service/set winbox <span class="nv">port</span><span class="o">=</span><span class="m">1951</span></span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
Preventing Brute Force
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
Whitelisting a Trusted Host
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p>To prevent accidental lockouts caused by the firewall filters we&#39;re about to create, whitelist your server IP address by running the following commands. This will create an IP Address list called TRUSTED, then add a firewall filter to always accept traffic.</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Our SERVER IP Address that get&#39;s whitlisted</span>
</span></span><span class="line"><span class="cl">/ip/firewall/address-list add <span class="nv">address</span><span class="o">=</span>192.168.1.10 <span class="nv">disabled</span><span class="o">=</span>no <span class="nv">list</span><span class="o">=</span>TRUSTED
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Creating a rule at INDEX 0 to always allow traffic from TRUSTED list</span>
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">action</span><span class="o">=</span>accept connection-state<span class="o">=</span>new src-address-list<span class="o">=</span>TRUSTED place-before<span class="o">=</span><span class="m">0</span> <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Allow Trusted&#34;</span>
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">action</span><span class="o">=</span>accept connection-state<span class="o">=</span>new src-address-list<span class="o">=</span>TRUSTED <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;Allow Trusted&#34;</span>
</span></span><span class="line"><span class="cl">Prevent FTP Brute Force
</span></span><span class="line"><span class="cl">After <span class="m">3</span> failed login attempts, block the IP from using FTP <span class="k">for</span> <span class="m">20</span> minutes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">21</span> src-address-list<span class="o">=</span>ftp_blacklist <span class="nv">action</span><span class="o">=</span>drop <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;drop ftp brute forcers&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">21</span> connection-state<span class="o">=</span>new <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            src-address-list<span class="o">=</span>ftp_stage3 <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>ftp_blacklist <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list-timeout<span class="o">=</span>20m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">21</span> connection-state<span class="o">=</span>new <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            src-address-list<span class="o">=</span>ftp_stage2 <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>ftp_stage3 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">21</span> connection-state<span class="o">=</span>new src-address-list<span class="o">=</span>ftp_stage1 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>ftp_stage2 address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">21</span> connection-state<span class="o">=</span>new <span class="nv">action</span><span class="o">=</span>add-src-to-address-list <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list<span class="o">=</span>ftp_stage1 address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-7" class="outline-3">
<h3 id="headline-7">
Preventing SSH Brute Force
</h3>
<div id="outline-text-headline-7" class="outline-text-3">
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1950</span> src-address-list<span class="o">=</span>ssh_blacklist <span class="nv">action</span><span class="o">=</span>drop <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;drop ssh brute forcers&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1950</span> connection-state<span class="o">=</span>new <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            src-address-list<span class="o">=</span>ssh_stage3 <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>ssh_blacklist <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list-timeout<span class="o">=</span>20m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1950</span> connection-state<span class="o">=</span>new <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            src-address-list<span class="o">=</span>ssh_stage2 <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>ssh_stage3 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1950</span> connection-state<span class="o">=</span>new src-address-list<span class="o">=</span>ssh_stage1 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>ssh_stage2 address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1950</span> connection-state<span class="o">=</span>new <span class="nv">action</span><span class="o">=</span>add-src-to-address-list <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list<span class="o">=</span>ssh_stage1 address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-8" class="outline-3">
<h3 id="headline-8">
Preventing WinBox Brute Force
</h3>
<div id="outline-text-headline-8" class="outline-text-3">
<p>After 3 failed login attempts, block the IP from using Winboxfor 20 minutes</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1951</span> src-address-list<span class="o">=</span>winbox_blacklist <span class="nv">action</span><span class="o">=</span>drop <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;drop winbox brute forcers&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1951</span> connection-state<span class="o">=</span>new <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            src-address-list<span class="o">=</span>winbox_stage3 <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>winbox_blacklist <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list-timeout<span class="o">=</span>20m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1951</span> connection-state<span class="o">=</span>new <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            src-address-list<span class="o">=</span>winbox_stage2 <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>winbox_stage3 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1951</span> connection-state<span class="o">=</span>new src-address-list<span class="o">=</span>winbox_stage1 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            <span class="nv">action</span><span class="o">=</span>add-src-to-address-list address-list<span class="o">=</span>winbox_stage2 address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip/firewall/filter add <span class="nv">chain</span><span class="o">=</span>input <span class="nv">protocol</span><span class="o">=</span>tcp dst-port<span class="o">=</span><span class="m">1951</span> connection-state<span class="o">=</span>new <span class="nv">action</span><span class="o">=</span>add-src-to-address-list <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>            address-list<span class="o">=</span>winbox_stage1 address-list-timeout<span class="o">=</span>1m <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-9" class="outline-2">
<h2 id="headline-9">
Disabling Access Via MAC Address
</h2>
<div id="outline-text-headline-9" class="outline-text-2">
<p>Here we&#39;ll disable any form of login using the Mac Address rather than IP address.</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/tool/mac-server <span class="nb">set</span> allowed-interface-list<span class="o">=</span>none
</span></span><span class="line"><span class="cl">/tool/mac-server print
</span></span><span class="line"><span class="cl">/tool/mac-server mac-winbox <span class="nb">set</span> allowed-interface-list<span class="o">=</span>none
</span></span><span class="line"><span class="cl">/tool/mac-server mac-winbox print
</span></span><span class="line"><span class="cl">/tool/mac-server ping <span class="nb">set</span> <span class="nv">enabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">/tool/mac-server ping print
</span></span><span class="line"><span class="cl">/ip neighbor discovery-settings <span class="nb">set</span> discover-interface-list<span class="o">=</span>none</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-10" class="outline-2">
<h2 id="headline-10">
Disabling Services
</h2>
<div id="outline-text-headline-10" class="outline-text-2">
<div id="outline-container-headline-11" class="outline-3">
<h3 id="headline-11">
Login Services
</h3>
<div id="outline-text-headline-11" class="outline-text-3">
<p>We only want SSH and WinBox services enabled. Here we&#39;ll disable everything except those</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/ip/service disable telnet,ftp,www,api,api-ssl
</span></span><span class="line"><span class="cl">/ip/service print</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-12" class="outline-3">
<h3 id="headline-12">
Miscellenous Services
</h3>
<div id="outline-text-headline-12" class="outline-text-3">
<p>These services should already be disabled, but let&#39;s do it explicitly.</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Disable Proxy Caching</span>
</span></span><span class="line"><span class="cl">/ip/proxy <span class="nb">set</span> <span class="nv">enabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Disable Socks Proxy</span>
</span></span><span class="line"><span class="cl">/ip/socks <span class="nb">set</span> <span class="nv">enabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Disable UPNP</span>
</span></span><span class="line"><span class="cl">/ip/upnp <span class="nb">set</span> <span class="nv">enabled</span><span class="o">=</span>no
</span></span><span class="line"><span class="cl">/tool/bandwidth-server <span class="nb">set</span> <span class="nv">enabled</span><span class="o">=</span>no</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-13" class="outline-3">
<h3 id="headline-13">
Disabling DNS cache
</h3>
<div id="outline-text-headline-13" class="outline-text-3">
<p>The router will cache DNS records by default. To avoid this causing any potential issues anything, we&#39;ll disable it</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/ip/dns <span class="nb">set</span> allow-remote-requests<span class="o">=</span>no</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/peterunix" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2023 Peter T.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noreferrer noopener">Hugo blog awesome</a>
        theme on
        <a href="https://gohugo.io" target="_blank" rel="noreferrer noopener">Hugo</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://peterunix.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>

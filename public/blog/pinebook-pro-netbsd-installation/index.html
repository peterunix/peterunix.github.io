<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
  <title>Pinebook Pro Netbsd Installation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/gtd.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.27.0/themes/prism-tomorrow.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.27.0/prism.min.js"></script>
</head>
<body>
  
<main>
  <h1>Pinebook Pro Netbsd Installation</h1>

  <nav class="toc">
    <nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Preface</a>
</li>
<li><a href="#headline-2">Configuring Network</a>
</li>
<li><a href="#headline-3">Configuring package manager</a>
</li>
<li><a href="#headline-4">Installing a desktop enviroment</a>
</li>
</ul>
</nav>
  </nav> 

  <article>
    
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Preface
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>I&#39;m going to assume that you&#39;ve already copied the <a href="https://wiki.pine64.org/index.php/Pinebook_Pro_Software_Release#NetBSD_.5BmicroSD_.2FeMMC_Boot.5D">netbsd</a> image to
your device and have booted into your system. If you have problems
booting from the microsd card, try disabling the emmc chip. It used to
be the case that you were only able to boot from microsd if the chip
was disabled. I&#39;m not sure if this was fixed.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Configuring Network
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>
There are two ways of doing this:</p>
<ol>
<li>Manually configuring wpa_supplicant</li>
<li>Using wpa_cli (frontend to wpa_supplicant)</li>
</ol>
<p>We&#39;re going to go over the manual method of setting up the network.
If you want to use wpa_cli, here&#39;s a <a href="https://wiki.archlinux.org/index.php/Wpa_supplicant#Connecting_with_wpa_cli">link</a> to the arch wiki page</p>
<p>
Let&#39;s identify our interface</p>
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ifconfig
</span></span><span style="display:flex;"><span>&gt; lo0 flags....
</span></span><span style="display:flex;"><span>&gt; run0: flags..... &lt;---- Substitute this interface <span style="color:#66d9ef">for</span> yours when referenced</span></span></code></pre></div>
</div>
<p>
Next we setup wpa_supplicant and dhcpcd to run at boot.</p>
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ vi /etc/rc.conf
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Append the following</span>
</span></span><span style="display:flex;"><span>dhcpcd<span style="color:#f92672">=</span>YES
</span></span><span style="display:flex;"><span>dhcpcd_flags<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>dhcpcd_flags<span style="color:#e6db74">}</span><span style="color:#e6db74"> -b&#34;</span>  <span style="color:#75715e">#This ensures boot wont hang when network isn&#39;t present</span>
</span></span><span style="display:flex;"><span>wpa_supplicant<span style="color:#f92672">=</span>YES
</span></span><span style="display:flex;"><span>wpa_supplicant_flags<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-B -i run0 -c /etc/wpa_supplicant.conf&#34;</span></span></span></code></pre></div>
</div>
<p>
Next we can add our network to /etc/wpa_supplicant.conf</p>
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ vi /etc/wpa_supplicant.conf
</span></span><span style="display:flex;"><span>ctrl_interface<span style="color:#f92672">=</span>/var/run/wpa_supplicant
</span></span><span style="display:flex;"><span>ctrl_interface_group<span style="color:#f92672">=</span>wheel
</span></span><span style="display:flex;"><span>update_config<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>network<span style="color:#f92672">={</span>
</span></span><span style="display:flex;"><span>        ssid<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;my favourite network&#34;</span>
</span></span><span style="display:flex;"><span>        psk<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hunter2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Starting wpa_supplicant</span>
</span></span><span style="display:flex;"><span>/etc/rc.d/wpa_supplicant start</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Configuring package manager
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>Netbsd has a commented URL for downloading binary packages in
~/.profile. Let&#39;s uncomment it</p>
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ vi ~/.profile
</span></span><span style="display:flex;"><span>export PKG_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://...&#34;</span></span></span></code></pre></div>
</div>
<p>
I believe at this point you have to log out and log back in, so the .profile is sourced again.
I just gave it a reboot instead. Let&#39;s install the &#34;pkgin&#34; package manager now.</p>
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pkg_add -v pkgin
</span></span><span style="display:flex;"><span>pkgin update
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Warning earm doesn&#39;t match your current architecture....&#34;</span>
</span></span><span style="display:flex;"><span>Still want to proceed? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span></span></span></code></pre></div>
</div>
<p>
Stop here. We have to make sure our architecture is set correctly, or else packages won&#39;t install properly.
Fortunatley this is pretty simple.</p>
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># Note how I overwrote the file.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If you choose to instead append the text, make sure you edit repositories.conf to delete the original url</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ echo $PKG_PATH &gt; /usr/pkg/etc/pkgin/repositories.conf</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Installing a desktop enviroment
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pkgin install xfce4 xinit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We have to link our X system so xinit can read from it.</span>
</span></span><span style="display:flex;"><span>ln -s /usr/X11R7/bin/X /usr/pkg/bin/X
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We add xfce4-session to our .xinitrc</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;exec xfce4-session&#34;</span> &gt; ~/.xinitrc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Finally we can boot into our desktop enviroment</span>
</span></span><span style="display:flex;"><span>startx</span></span></code></pre></div>
</div>
<p>
Give XFCE4 a moment to load in.
Alt+f1 will bring you back to the tty prompt.
Alt+f2 will bring you to the gui</p>
</div>
</div>

  </article>
</main>

</body>
</html>
